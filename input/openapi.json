{
    "openapi":"3.0.1",
    "info":{
       "title":"Lakehouse Optimizer REST APIs",
       "description":"This describes various API's to interact with Cloudera Lakehouse Optimizer service. You can find out more about Lakehouse Optimizer at [Cloudera Lakehouse Optimizer doc](https://docs.cloudera.com/runtime/latest/clo-for-iceberg-tables.pdf).",
       "termsOfService":"http://swagger.io/terms/",
       "contact":{
          "email":"ngangam@cloudera.com, hbiestro@cloudera.com, zdeng@cloudera.com, vrai@cloudera.com, prabhatmishra@cloudera.com"
       },
       "license":{
          "name":"Apache 2.0",
          "url":"http://www.apache.org/licenses/LICENSE-2.0.html"
       },
       "version":"1.0"
    },
    "servers":[
       {
          "url":"/clo/api/v1"
       },
       {
          "description":"knox based cdp-proxy-token endpoint",
          "url":"/lakehous-7qx85d/cdp-proxy-token/clo/api/v1"
       }
    ],
    "security":[
       {
          "BearerAuth":[
             
          ]
       }
    ],
    "paths":{
       "/namespaces/{namespace}/policies":{
          "get":{
             "tags":[
                "namespaces"
             ],
             "summary":"List policies associated to at-least one of the tables of a namespace",
             "description":"Fetches the policy names associated to at-least one tables of a namespace",
             "operationId":"fetchPolicies",
             "parameters":[
                {
                   "name":"namespace",
                   "in":"path",
                   "required":true,
                   "schema":{
                      "type":"string"
                   }
                }
             ],
             "responses":{
                "200":{
                   "description":"Policies name fetch is successful",
                   "content":{
                      "application/json":{
                         "schema":{
                            "type":"object",
                            "properties":{
                               "result":{
                                  "type":"string"
                               }
                            }
                         },
                         "examples":{
                            "Active Namespaces Response":{
                               "description":"Active Namespaces Response",
                               "value":{
                                  "status":200,
                                  "action":"READ",
                                  "policies":[
                                     "p1"
                                  ],
                                  "message":"Namespace : namespaces"
                               }
                            }
                         }
                      }
                   }
                },
                "404":{
                   "description":"Namespace not found or not declared",
                   "content":{
                      "application/json":{
                         "examples":{
                            "Namespace not found Response":{
                               "description":"Namespace not found Response",
                               "value":{
                                  "status":404,
                                  "action":"ERROR",
                                  "message":"Namespace : namespaces"
                               }
                            }
                         }
                      }
                   }
                }
             }
          }
       },
       "/namespaces/active":{
          "get":{
             "tags":[
                "namespaces"
             ],
             "summary":"Get all active namespaces",
             "description":"Retrieves a list of all active namespaces.",
             "operationId":"getAllNamespaces",
             "responses":{
                "200":{
                   "content":{
                      "application/json":{
                         "examples":{
                            "Active Namespaces Response":{
                               "description":"Active Namespaces Response",
                               "value":{
                                  "status":200,
                                  "action":"READ",
                                  "result":[
                                     "test",
                                     "production"
                                  ],
                                  "message":"Active namespaces"
                               }
                            }
                         }
                      }
                   }
                }
             }
          }
       },
       "/namespaces":{
          "get":{
             "tags":[
                "namespaces"
             ],
             "summary":"Get all known namespaces",
             "description":"Retrieves a list of all namespaces.",
             "operationId":"getAllNamespaces_1",
             "parameters":[
                {
                   "name":"fetch",
                   "in":"query",
                   "description":"If true fetch all namespaces in catalog else fetch namespaces which are declared to be maintained",
                   "schema":{
                      "type":"boolean"
                   },
                   "example":true
                }
             ],
             "responses":{
                "200":{
                   "content":{
                      "application/json":{
                         "examples":{
                            "List Namespace Response":{
                               "description":"List Namespace Response",
                               "value":{
                                  "status":"200",
                                  "action":"READ",
                                  "result":[
                                     "test",
                                     "production"
                                  ],
                                  "message":"All namespaces"
                               }
                            }
                         }
                      }
                   }
                }
             }
          }
       },
       "components":{
          "schemas":{
             "LoginRequest":{
                "type":"object",
                "properties":{
                   "clientId":{
                      "type":"string"
                   },
                   "clientSecret":{
                      "type":"string"
                   }
                }
             },
             "PolicyAssociationDto":{
                "type":"object",
                "properties":{
                   "associations":{
                      "type":"array",
                      "items":{
                         "type":"string"
                      }
                   }
                }
             },
             "FormDataContentDisposition":{
                "type":"object",
                "properties":{
                   "type":{
                      "type":"string"
                   },
                   "parameters":{
                      "type":"object",
                      "additionalProperties":{
                         "type":"string"
                      }
                   },
                   "fileName":{
                      "type":"string"
                   },
                   "creationDate":{
                      "type":"string",
                      "format":"date-time"
                   },
                   "modificationDate":{
                      "type":"string",
                      "format":"date-time"
                   },
                   "readDate":{
                      "type":"string",
                      "format":"date-time"
                   },
                   "size":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "name":{
                      "type":"string"
                   }
                }
             },
             "ResourceUploadDto":{
                "type":"object",
                "properties":{
                   "script":{
                      "type":"string"
                   },
                   "constants":{
                      "type":"string"
                   }
                }
             },
             "BodyPart":{
                "type":"object",
                "properties":{
                   "contentDisposition":{
                      "$ref":"#/components/schemas/ContentDisposition"
                   },
                   "entity":{
                      "type":"object"
                   },
                   "headers":{
                      "type":"object",
                      "additionalProperties":{
                         "type":"array",
                         "items":{
                            "type":"string"
                         }
                      }
                   },
                   "mediaType":{
                      "type":"object",
                      "properties":{
                         "type":{
                            "type":"string"
                         },
                         "subtype":{
                            "type":"string"
                         },
                         "parameters":{
                            "type":"object",
                            "additionalProperties":{
                               "type":"string"
                            }
                         },
                         "wildcardType":{
                            "type":"boolean"
                         },
                         "wildcardSubtype":{
                            "type":"boolean"
                         }
                      }
                   },
                   "messageBodyWorkers":{
                      "$ref":"#/components/schemas/MessageBodyWorkers"
                   },
                   "parent":{
                      "$ref":"#/components/schemas/MultiPart"
                   },
                   "providers":{
                      "type":"object"
                   },
                   "parameterizedHeaders":{
                      "type":"object",
                      "additionalProperties":{
                         "type":"array",
                         "items":{
                            "$ref":"#/components/schemas/ParameterizedHeader"
                         }
                      }
                   }
                }
             },
             "ContentDisposition":{
                "type":"object",
                "properties":{
                   "type":{
                      "type":"string"
                   },
                   "parameters":{
                      "type":"object",
                      "additionalProperties":{
                         "type":"string"
                      }
                   },
                   "fileName":{
                      "type":"string"
                   },
                   "creationDate":{
                      "type":"string",
                      "format":"date-time"
                   },
                   "modificationDate":{
                      "type":"string",
                      "format":"date-time"
                   },
                   "readDate":{
                      "type":"string",
                      "format":"date-time"
                   },
                   "size":{
                      "type":"integer",
                      "format":"int64"
                   }
                }
             },
             "FormDataBodyPart":{
                "type":"object",
                "properties":{
                   "contentDisposition":{
                      "$ref":"#/components/schemas/ContentDisposition"
                   },
                   "entity":{
                      "type":"object"
                   },
                   "headers":{
                      "type":"object",
                      "additionalProperties":{
                         "type":"array",
                         "items":{
                            "type":"string"
                         }
                      }
                   },
                   "mediaType":{
                      "type":"object",
                      "properties":{
                         "type":{
                            "type":"string"
                         },
                         "subtype":{
                            "type":"string"
                         },
                         "parameters":{
                            "type":"object",
                            "additionalProperties":{
                               "type":"string"
                            }
                         },
                         "wildcardType":{
                            "type":"boolean"
                         },
                         "wildcardSubtype":{
                            "type":"boolean"
                         }
                      }
                   },
                   "messageBodyWorkers":{
                      "$ref":"#/components/schemas/MessageBodyWorkers"
                   },
                   "parent":{
                      "$ref":"#/components/schemas/MultiPart"
                   },
                   "providers":{
                      "type":"object"
                   },
                   "simple":{
                      "type":"boolean"
                   },
                   "formDataContentDisposition":{
                      "$ref":"#/components/schemas/FormDataContentDisposition"
                   },
                   "name":{
                      "type":"string"
                   },
                   "value":{
                      "type":"string"
                   },
                   "parameterizedHeaders":{
                      "type":"object",
                      "additionalProperties":{
                         "type":"array",
                         "items":{
                            "$ref":"#/components/schemas/ParameterizedHeader"
                         }
                      }
                   }
                }
             },
             "FormDataMultiPart":{
                "type":"object",
                "properties":{
                   "contentDisposition":{
                      "$ref":"#/components/schemas/ContentDisposition"
                   },
                   "entity":{
                      "type":"object"
                   },
                   "headers":{
                      "type":"object",
                      "additionalProperties":{
                         "type":"array",
                         "items":{
                            "type":"string"
                         }
                      }
                   },
                   "mediaType":{
                      "type":"object",
                      "properties":{
                         "type":{
                            "type":"string"
                         },
                         "subtype":{
                            "type":"string"
                         },
                         "parameters":{
                            "type":"object",
                            "additionalProperties":{
                               "type":"string"
                            }
                         },
                         "wildcardType":{
                            "type":"boolean"
                         },
                         "wildcardSubtype":{
                            "type":"boolean"
                         }
                      }
                   },
                   "messageBodyWorkers":{
                      "$ref":"#/components/schemas/MessageBodyWorkers"
                   },
                   "parent":{
                      "$ref":"#/components/schemas/MultiPart"
                   },
                   "providers":{
                      "type":"object"
                   },
                   "bodyParts":{
                      "type":"array",
                      "items":{
                         "$ref":"#/components/schemas/BodyPart"
                      }
                   },
                   "fields":{
                      "type":"object",
                      "additionalProperties":{
                         "type":"array",
                         "items":{
                            "$ref":"#/components/schemas/FormDataBodyPart"
                         }
                      }
                   },
                   "parameterizedHeaders":{
                      "type":"object",
                      "additionalProperties":{
                         "type":"array",
                         "items":{
                            "$ref":"#/components/schemas/ParameterizedHeader"
                         }
                      }
                   }
                }
             },
             "MessageBodyWorkers":{
                "type":"object"
             },
             "MultiPart":{
                "type":"object",
                "properties":{
                   "contentDisposition":{
                      "$ref":"#/components/schemas/ContentDisposition"
                   },
                   "entity":{
                      "type":"object"
                   },
                   "headers":{
                      "type":"object",
                      "additionalProperties":{
                         "type":"array",
                         "items":{
                            "type":"string"
                         }
                      }
                   },
                   "mediaType":{
                      "type":"object",
                      "properties":{
                         "type":{
                            "type":"string"
                         },
                         "subtype":{
                            "type":"string"
                         },
                         "parameters":{
                            "type":"object",
                            "additionalProperties":{
                               "type":"string"
                            }
                         },
                         "wildcardType":{
                            "type":"boolean"
                         },
                         "wildcardSubtype":{
                            "type":"boolean"
                         }
                      }
                   },
                   "messageBodyWorkers":{
                      "$ref":"#/components/schemas/MessageBodyWorkers"
                   },
                   "parent":{
                      "$ref":"#/components/schemas/MultiPart"
                   },
                   "providers":{
                      "type":"object"
                   },
                   "bodyParts":{
                      "type":"array",
                      "items":{
                         "$ref":"#/components/schemas/BodyPart"
                      }
                   },
                   "parameterizedHeaders":{
                      "type":"object",
                      "additionalProperties":{
                         "type":"array",
                         "items":{
                            "$ref":"#/components/schemas/ParameterizedHeader"
                         }
                      }
                   }
                }
             },
             "ParameterizedHeader":{
                "type":"object",
                "properties":{
                   "value":{
                      "type":"string"
                   },
                   "parameters":{
                      "type":"object",
                      "additionalProperties":{
                         "type":"string"
                      }
                   }
                }
             },
             "PolicyConstants":{
                "type":"object",
                "properties":{
                   "expireSnapshot":{
                      "type":"object",
                      "additionalProperties":{
                         "type":"object"
                      }
                   },
                   "rewriteDataFiles":{
                      "type":"object",
                      "additionalProperties":{
                         "type":"object"
                      }
                   },
                   "rewriteManifest":{
                      "type":"object",
                      "additionalProperties":{
                         "type":"object"
                      }
                   },
                   "deleteOrphanFiles":{
                      "type":"object",
                      "additionalProperties":{
                         "type":"object"
                      }
                   },
                   "rewritePositionDelete":{
                      "type":"object",
                      "additionalProperties":{
                         "type":"object"
                      }
                   },
                   "cron":{
                      "type":"string"
                   },
                   "timeZone":{
                      "type":"string"
                   },
                   "label":{
                      "type":"string"
                   },
                   "script":{
                      "type":"string"
                   },
                   "description":{
                      "type":"string"
                   },
                   "extra":{
                      "type":"object",
                      "additionalProperties":{
                         "type":"object"
                      }
                   }
                },
                "example":{
                   "actions":{
                      "expireSnapshots":{
                         "expireOlderThan":5000,
                         "retainLast":50
                      },
                      "deleteOrphanFiles":{
                         "olderThan":500,
                         "location":"hdfs://default.com",
                         "tag":"default"
                      }
                   },
                   "array-prop":[
                      5,
                      6
                   ]
                }
             },
             "PolicyDetail":{
                "type":"object",
                "properties":{
                   "uuid":{
                      "type":"string",
                      "example":"02dba0e3-064d-5246-9576-af21aebac5b0"
                   },
                   "scriptName":{
                      "type":"string",
                      "example":"snapshots-daily.jexl"
                   },
                   "constants":{
                      "$ref":"#/components/schemas/PolicyConstants"
                   }
                }
             },
             "AfterCompaction":{
                "type":"object"
             },
             "CurrentSnapshot":{
                "type":"object",
                "properties":{
                   "dataDeleteFilesCount":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "manifestFilesCount":{
                      "type":"integer",
                      "format":"int64"
                   }
                }
             },
             "IcebergTableStats":{
                "type":"object",
                "properties":{
                   "numberOfSnapshots":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "currentSequenceNumber":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "firstSequenceNumber":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "currentSnapshotTimestamp":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "oldestSnapshotTimestamp":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "snapshotId":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "catalogName":{
                      "type":"string"
                   },
                   "tableName":{
                      "type":"string"
                   },
                   "nameSpace":{
                      "type":"string"
                   },
                   "recordTimestamp":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "currentSnapshotManifestFilesCount":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "currentSnapshotDataDeleteFilesCount":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "directoryObjectsCount":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "directoryObjectsSize":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "partitionStats":{
                      "type":"object",
                      "additionalProperties":{
                         "$ref":"#/components/schemas/Partition"
                      }
                   },
                   "partitionCount":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "currentSnapshot":{
                      "$ref":"#/components/schemas/CurrentSnapshot"
                   },
                   "afterCompaction":{
                      "$ref":"#/components/schemas/AfterCompaction"
                   },
                   "sequenceNumberDelta":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "snapshotTimestampDelta":{
                      "type":"integer",
                      "format":"int64"
                   }
                }
             },
             "Partition":{
                "type":"object",
                "properties":{
                   "partitionKey":{
                      "type":"string"
                   },
                   "totalDataFiles":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "totalFileSize":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "totalDeleteFiles":{
                      "type":"integer",
                      "format":"int64"
                   }
                }
             },
             "TableErrorHandler":{
                "type":"object",
                "properties":{
                   "defaultPenaltyTime":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "defaultForgetTimeSinceLastReport":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "defaultTolerance":{
                      "type":"integer",
                      "format":"int32"
                   },
                   "pausedKeys":{
                      "type":"array",
                      "items":{
                         "$ref":"#/components/schemas/TablePath"
                      }
                   }
                }
             },
             "TableIdentifier":{
                "type":"object"
             },
             "TablePath":{
                "type":"object",
                "properties":{
                   "catalog":{
                      "type":"string"
                   },
                   "namespace":{
                      "type":"string"
                   },
                   "table":{
                      "type":"string"
                   },
                   "identifier":{
                      "$ref":"#/components/schemas/TableIdentifier"
                   }
                }
             },
             "EventIngestionMetadata":{
                "type":"object",
                "properties":{
                   "ingestionId":{
                      "type":"string"
                   },
                   "startedAt":{
                      "type":"string"
                   },
                   "finishedAt":{
                      "type":"string"
                   },
                   "status":{
                      "type":"string",
                      "enum":[
                         "IN_PROGRESS",
                         "COMPLETED",
                         "FAILED"
                      ]
                   },
                   "message":{
                      "type":"string"
                   },
                   "currentFileIndex":{
                      "type":"integer",
                      "format":"int32"
                   },
                   "currentFileRow":{
                      "type":"integer",
                      "format":"int32"
                   },
                   "ingestedRecordCount":{
                      "type":"integer",
                      "format":"int64"
                   }
                }
             },
             "TaskMetadata":{
                "type":"object",
                "properties":{
                   "taskId":{
                      "type":"string",
                      "format":"uuid",
                      "example":"4cd03968-5a58-5474-8e03-2513cddfbe31"
                   },
                   "createdAt":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "createdBy":{
                      "type":"integer",
                      "format":"int64"
                   },
                   "tablePath":{
                      "$ref":"#/components/schemas/TablePath"
                   },
                   "policyName":{
                      "type":"string",
                      "example":"snapshot-daily"
                   },
                   "policyVersion":{
                      "type":"string",
                      "format":"uuid",
                      "example":"02dba0e3-064d-5246-9576-af21aebac5b0"
                   },
                   "currentAction":{
                      "type":"string",
                      "enum":[
                         "DELETE_ORPHAN_FILES",
                         "DELETE_REACHABLE_FILES",
                         "EXPIRE_SNAPSHOT",
                         "REWRITE_DATA_FILES",
                         "REWRITE_MANIFEST",
                         "REWRITE_POSITION_DELETE_FILES",
                         "MIGRATE_TABLE",
                         "SNAPSHOT_TABLE",
                         "NOOP"
                      ]
                   },
                   "actions":{
                      "type":"object",
                      "additionalProperties":{
                         "type":"object",
                         "additionalProperties":{
                            "type":"object",
                            "example":{
                               "EXPIRE_SNAPSHOT":{
                                  "status":"Failed"
                               }
                            }
                         },
                         "example":{
                            "EXPIRE_SNAPSHOT":{
                               "status":"Failed"
                            }
                         }
                      },
                      "example":{
                         "EXPIRE_SNAPSHOT":{
                            "status":"Failed"
                         }
                      }
                   },
                   "status":{
                      "type":"string",
                      "enum":[
                         "INIT",
                         "SUBMITTED",
                         "COMPLETED",
                         "FAILED"
                      ]
                   },
                   "message":{
                      "type":"string"
                   },
                   "namespace":{
                      "type":"string"
                   },
                   "tableName":{
                      "type":"string"
                   },
                   "catalogName":{
                      "type":"string"
                   }
                }
             }
          },
          "securitySchemes":{
             "BearerAuth":{
                "type":"http",
                "scheme":"bearer",
                "bearerFormat":"JWT"
             }
          }
       }
    }
 }